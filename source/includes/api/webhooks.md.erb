# Web Hooks

A customer can provide a single URL to be called with a notifications when various events occur related to his/her orders. Also customers may opt-in/out to various order/order item events that fire notifications.


## Create a Web Hook

This endpoint will submit a new Web hook record.

- Customers should only have one Web Hook.
- The URL for a customer's webhook must be unique.

<%= partial "includes/api/curl_snippets/post_webhook_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/post_webhook_response.md" %>

> User and URL must be unique, otherwise an 422 will be returned

<%= partial "includes/api/json_snippets/post_webhook_error.md" %>

### HTTPS Request

`POST https://api.mwwondemand.com/api/webhooks`


### POST Parameters

Parameter | Default / Type | Description
--------- | ------- | -----------
data | {} | The root element of your JSON post object.
type | webhooks | Resource the object represents.
attributes | {} | The object that contains all the pertanent information about the order.
attributes[url] | nil | String: the URL to receive callback notifications
attributes[enabled] | true | Boolean: Pause notifications by setting false
attributes[received] | true | Boolean: Fired when order is received
attributes[design-downloaded] | false | Boolean: Fired after item design downloaded
attributes[processed] | true | Boolean: Fired after processing complete for order/items
attributes[shipped] | true | Boolean: Fired when an order/item ships
attributes[cancelled] | true | Boolean: Fired when an order/item is cancelled
attributes[printed] | false | Boolean: Fired after an item is printed
attributes[pressed] | false | Boolean: Fired after an item is pressed
attributes[cut] | false | Boolean: Fired after an item is cut
attributes[sewn] | false | Boolean: Fired after an item is sewn
attributes[turned] | false | Boolean: Fired after an item is turned
attributes[packed] | false | Boolean: Fired after an item is packed

*Note: This endpoint follows the [JSON API 1.0 Spec](http://jsonapi.org/format/1.0/)*


### Errors

- 422 Unprocessable Entity

Code | Attribute | Description
---- | --------- | -----------
422 | user-id | Customer can only have one Web hook
422 | url | URL must be unique in the MWWOndemand system


## Show Web Hook Details

Shows Web hook attributes.

`GET https://api.mwwondemand.com/api/webhooks`

Or,

`GET https://api.mwwondemand.com/api/webhooks/:id`

<%= partial "includes/api/curl_snippets/get_webhooks_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/get_webhooks_response.md" %>


## Patch Web hook Attributes

Update attributes, e.g. opt-in to receive notifications for additional events.

`GET https://api.mwwondemand.com/api/webhooks/:id`

<%= partial "includes/api/curl_snippets/patch_webhook_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/patch_webhook_response.md" %>


## Delete Web Hook

Remove customer Web hook.

`GET https://api.mwwondemand.com/api/webhooks/:id`

<%= partial "includes/api/curl_snippets/delete_webhook_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/delete_webhook_response.md" %>

## Web Hook Notifications

> Example POST payload (JSON) for the (order) `received` event:

<%= partial "includes/api/json_snippets/post_webhook_notification.md" %>

Based on your opt-in preferences for various events, the API will POST back
to the your Web Hook URL. The web hook url and settings are available in your
profile, see the <https://api.mwwondemand.com/account/> page.

The `url` (string) must be a valid URL (an API endpoint you host) and the
`enabled` (boolean) setting must be checked.

First login, then visit <https://api.mwwondemand.com/account/user/webhooks> to
edit your Web Hooks (opt-in) preferences.

- The `enabled` checkbox must be `checked` in order to receive POST notifications.
- Check the various events that you would like to receive notifications for.

Events for Orders | Events for Items
----------------- | ----------------
Received | Printed
Design Downloaded | Pressed
Not Valid | Cut
Processed | Sewn
Shipped | Turned
Cancelled | Packed

To the right is an example JSON payload for a POST notification sent after an
order is received.
